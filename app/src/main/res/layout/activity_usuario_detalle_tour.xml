<?xml version="1.0" encoding="utf-8"?>
<androidx.coordinatorlayout.widget.CoordinatorLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@android:color/white"
    android:clipChildren="false"
    android:clipToPadding="false"
    android:fitsSystemWindows="true">

    <!-- =========================
         HERO ESTÁTICA (no scrollea)
         Ajusta HERO_HEIGHT_DP aquí
         ========================= -->
    <FrameLayout
        android:id="@+id/heroContainer"
        android:layout_width="match_parent"
        android:layout_height="360dp"
        android:fitsSystemWindows="true"> <!-- HERO_HEIGHT_DP -->

        <ImageView
            android:id="@+id/iv_machu_picchu"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:contentDescription="@null"
            android:scaleType="centerCrop"
            android:src="@drawable/machu_picchu" />

        <!-- Scrim superior para legibilidad del título -->
        <ImageView
            android:id="@+id/scrimTop"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:importantForAccessibility="no"
            android:scaleType="fitXY"
            android:src="@drawable/scrim_top"/>
    </FrameLayout>

    <!-- =========================
         TOOLBAR FIJO Y TRANSPARENTE
         (sin lift ni scrim de color)
         ========================= -->
    <com.google.android.material.appbar.AppBarLayout
        android:id="@+id/appBarLayout"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="@android:color/transparent"
        android:elevation="0dp"
        android:stateListAnimator="@null"
        app:liftOnScroll="false"
        android:fitsSystemWindows="true">

        <com.google.android.material.appbar.MaterialToolbar
            android:id="@+id/toolbarDetalle"
            android:layout_width="match_parent"
            android:layout_height="?attr/actionBarSize"
            android:background="@android:color/transparent"
            android:elevation="0dp"
            android:stateListAnimator="@null"
            app:contentInsetLeft="0dp"
            app:contentInsetStart="0dp"
            app:contentInsetStartWithNavigation="0dp">

            <!-- Back blanco con fondo circular translúcido -->
            <androidx.appcompat.widget.AppCompatImageButton
                android:id="@+id/btn_back"
                android:layout_width="40dp"
                android:layout_height="40dp"
                android:layout_gravity="start|center_vertical"
                android:background="@drawable/bg_circle_white"
                android:padding="8dp"
                android:src="@drawable/ic_arrow_back"
                android:tint="@android:color/white"
                android:contentDescription="@null"/>

            <!-- Título centrado -->
            <TextView
                android:id="@+id/tv_toolbar_title"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:gravity="center"
                android:text="Detalles"
                android:textStyle="bold"
                android:textSize="20sp"
                android:textColor="@android:color/white"/>
        </com.google.android.material.appbar.MaterialToolbar>
    </com.google.android.material.appbar.AppBarLayout>

    <!-- =========================
         CONTENIDO SCROLLEABLE
         paddingTop = HERO_HEIGHT_DP - PEEK_HEIGHT_DP
         (Ajusta PEEK cambiando este paddingTop)
         ========================= -->
    <androidx.core.widget.NestedScrollView
        android:id="@+id/nestedScrollView"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:clipChildren="false"
        android:clipToPadding="false"
        android:paddingTop="248dp"
        android:paddingBottom="96dp"
        app:layout_behavior="@string/appbar_scrolling_view_behavior">

    <!-- Card a ancho completo, con solape suave y radios SOLO arriba -->
    <com.google.android.material.card.MaterialCardView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="-24dp"
        android:translationZ="8dp"
        android:backgroundTint="@android:color/white"
        app:cardElevation="8dp"
        app:cardUseCompatPadding="false"
        app:shapeAppearanceOverlay="@style/ShapeAppearanceOverlay.App.CardView.TopRounded"
        app:contentPaddingLeft="26dp"
        app:contentPaddingRight="26dp"
        app:contentPaddingTop="24dp"
        app:contentPaddingBottom="28dp">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical">

        <!-- Título y ubicación -->
        <TextView
            android:id="@+id/tvTitulo"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Machu Picchu"
            android:textAppearance="@style/TextAppearance.Material3.HeadlineSmall"
            android:textColor="@android:color/black"/>

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="horizontal"
            android:gravity="center_vertical"
            android:layout_marginTop="6dp">

            <ImageView
                android:layout_width="16dp"
                android:layout_height="16dp"
                android:src="@drawable/ic_location"
                app:tint="?attr/colorPrimary"/>

            <TextView
                android:id="@+id/tvUbicacion"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Cusco"
                android:layout_marginStart="6dp"
                android:textAppearance="@style/TextAppearance.Material3.BodyMedium"/>

            <ImageView
                android:layout_width="16dp"
                android:layout_height="16dp"
                android:layout_marginStart="12dp"
                android:src="@drawable/ic_star"
                app:tint="#FFC107"/>

            <TextView
                android:id="@+id/tvRating"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="5.0"
                android:layout_marginStart="6dp"
                android:textAppearance="@style/TextAppearance.Material3.BodyMedium"/>
        </LinearLayout>

        <!-- Descripción -->
        <TextView
            android:id="@+id/tvDescripcionTitulo"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Descripción"
            android:textStyle="bold"
            android:layout_marginTop="16dp"
            android:textAppearance="@style/TextAppearance.Material3.TitleMedium"/>

        <TextView
            android:id="@+id/tvDescripcion"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="Vive la magia de Machu Picchu en un día inolvidable. Partimos temprano desde Cusco rumbo..."
            android:textAppearance="@style/TextAppearance.Material3.BodyMedium"
            android:layout_marginTop="6dp"/>

        <TextView
            android:id="@+id/btnVerMasDescripcion"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Ver más"
            android:textColor="?attr/colorPrimary"
            android:textStyle="bold"
            android:layout_marginTop="4dp"/>

        <!-- Adicional -->
        <TextView
            android:id="@+id/tvAdicionalTitulo"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Adicional"
            android:textStyle="bold"
            android:layout_marginTop="18dp"
            android:textAppearance="@style/TextAppearance.Material3.TitleMedium"/>

        <TextView
            android:id="@+id/tvAdicional"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="El tour incluye:\n- Traslados hacia el destino\n- Desayuno..."
            android:textAppearance="@style/TextAppearance.Material3.BodyMedium"
            android:layout_marginTop="6dp"/>

        <TextView
            android:id="@+id/btnVerMasAdicional"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Ver más"
            android:textColor="?attr/colorPrimary"
            android:textStyle="bold"
            android:layout_marginTop="4dp"/>

        <!-- Recorrido -->
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal"
            android:layout_marginTop="18dp"
            android:gravity="center_vertical">

            <TextView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="Recorrido"
                android:textStyle="bold"
                android:textAppearance="@style/TextAppearance.Material3.TitleMedium"/>

            <TextView
                android:id="@+id/btnVerMapa"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Ver en el mapa"
                android:textColor="?attr/colorPrimary"
                android:textStyle="bold"/>
        </LinearLayout>

        <ImageView
            android:id="@+id/imgMapa"
            android:layout_width="match_parent"
            android:layout_height="180dp"
            android:scaleType="centerCrop"
            android:src="@drawable/default_route"
            android:layout_marginTop="10dp"/>

        <!-- Fotos -->
        <TextView
            android:id="@+id/tvFotosTitulo"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Fotos"
            android:textStyle="bold"
            android:layout_marginTop="18dp"
            android:textAppearance="@style/TextAppearance.Material3.TitleMedium"/>

        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/rvFotos"
            android:layout_width="match_parent"
            android:layout_height="120dp"
            android:orientation="horizontal"
            android:overScrollMode="never"
            android:scrollbars="none"
            android:layout_marginTop="10dp"/>

        <!-- Reseñas -->
        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal"
            android:layout_marginTop="18dp"
            android:gravity="center_vertical">

            <TextView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:text="Reseñas"
                android:textStyle="bold"
                android:textAppearance="@style/TextAppearance.Material3.TitleMedium"/>

            <TextView
                android:id="@+id/btnVerTodasResenas"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Ver todo"
                android:textColor="?attr/colorPrimary"
                android:textStyle="bold"/>
        </LinearLayout>

        <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/rvResenas"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:nestedScrollingEnabled="false"
            android:layout_marginTop="10dp"/>
    </LinearLayout>
</com.google.android.material.card.MaterialCardView>
    </androidx.core.widget.NestedScrollView>

    <!-- =========================
         BARRA INFERIOR FIJA
         ========================= -->
<com.google.android.material.card.MaterialCardView
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_gravity="bottom"
android:backgroundTint="@android:color/white"
android:padding="12dp"
app:cardElevation="12dp">

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:gravity="center_vertical"
    android:padding="20dp">

    <LinearLayout
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:orientation="vertical">

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Precio"
            android:textColor="#666666"
            android:textSize="14sp" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="horizontal">

            <TextView
                android:id="@+id/tvPrecioUnitDetalle"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="S/300"
                android:textColor="@android:color/black"
                android:textSize="24sp"
                android:textStyle="bold" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="/persona"
                android:textColor="#666666"
                android:textSize="14sp"
                android:layout_marginStart="2dp" />
        </LinearLayout>
    </LinearLayout>

    <Button
        android:id="@+id/btn_reservar"
        android:layout_width="wrap_content"
        android:layout_height="50dp"
        android:text="Reserva ahora"
        android:textColor="@android:color/white"
        android:textSize="16sp"
        android:textStyle="bold"
        android:background="@drawable/button_primary_background"
        android:paddingStart="24dp"
        android:paddingEnd="24dp"
        android:elevation="2dp" />
</LinearLayout>
</com.google.android.material.card.MaterialCardView>

    </androidx.coordinatorlayout.widget.CoordinatorLayout>
